"""
Given a non-empty array of unique positive integers A, consider the following graph:

There are A.length nodes, labelled A[0] to A[A.length - 1];
There is an edge between A[i] and A[j] if and only if A[i] and A[j] share a common factor greater than 1.
Return the size of the largest connected component in the graph.

1 <= A.length <= 20000
1 <= A[i] <= 100000

****  Time Limit Exceeded ****
 TODO think a solution with less operations

"""


class DisjointSet:
    def __init__(self, n):
        self.disjoint_set = [x for x in range(n)]
        self.size = [1] * n

    def find(self, x):
        if self.disjoint_set[x] != x:
            self.disjoint_set[x] = self.find(self.disjoint_set[x])
        return self.disjoint_set[x]

    def union(self, x, y):
        x_root = self.find(x)
        y_root = self.find(y)
        if x_root == y_root:
            return
        self.disjoint_set[x_root] = y_root
        self.size[y_root] += self.size[x_root]
        self.size[x_root] = 0


class Solution:
    @staticmethod
    def largest_component_size(A: list) -> int:
        def gdc(a, b):
            if b == 0:
                return a
            else:
                return gdc(b, a % b)

        graph_size = len(A)
        ds = DisjointSet(graph_size)
        # first we create the graph
        for i in range(0, graph_size):
            for j in range(0, graph_size):
                if i != j and gdc(A[i], A[j]) > 1:
                    ds.union(i, j)
        return max(ds.size)


if __name__ == '__main__':
    print(Solution().largest_component_size(
        [3, 6149, 9, 2060, 7229, 2062, 1709, 4114, 4122, 2075, 29, 2078, 31, 6183, 4136, 6185, 274, 8238, 2095, 48,
         8242, 8243, 4149, 8246, 4152, 6202, 6203, 4912, 66, 6212, 4168, 2121, 6218, 6219, 77, 8270, 79, 6225, 4178,
         2131, 14, 87, 88, 4186, 93, 6241, 100, 8293, 3089, 4200, 4203, 2156, 4205, 6254, 9235, 6260, 8553, 8313, 6268,
         8318, 127, 1728, 4232, 4234, 7874, 4238, 9581, 8338, 8461, 4245, 8342, 2201, 6299, 156, 4847, 6310, 4465, 1052,
         6317, 4273, 8374, 184, 4281, 8378, 6331, 7644, 2238, 9008, 6336, 2243, 197, 6343, 2249, 6347, 2252, 4302, 207,
         208, 2257, 2258, 211, 216, 8410, 719, 4317, 6367, 2275, 8420, 229, 721, 232, 2281, 8231, 1705, 4334, 6383,
         2288, 2289, 6386, 6387, 8436, 248, 4345, 8442, 2299, 6398, 263, 3799, 8460, 3458, 3800, 6418, 8467, 388, 8479,
         289, 4388, 2342, 4391, 296, 7900, 4394, 2349, 302, 8496, 305, 6450, 4405, 8330, 2359, 4408, 2361, 2364, 8509,
         6462, 8512, 4419, 8516, 4422, 4423, 328, 7223, 4429, 6479, 6481, 4434, 4437, 2391, 6543, 348, 6494, 4449, 355,
         357, 6505, 743, 6509, 3831, 369, 8565, 374, 3135, 6525, 2430, 5525, 2436, 389, 5185, 8585, 6540, 398, 2447,
         2448, 2456, 2451, 2452, 6550, 2457, 6492, 409, 6555, 8604, 3824, 423, 4520, 8617, 429, 6575, 4528, 3144, 434,
         2483, 2488, 6587, 4543, 1447, 2504, 2505, 1783, 8653, 6221, 466, 1443, 2126, 8664, 4569, 4570, 4573, 481, 8675,
         2533, 6630, 4177, 2536, 489, 5540, 492, 493, 494, 4592, 6641, 4595, 2548, 6645, 8694, 8696, 4606, 8706, 4613,
         2566, 520, 521, 2570, 7255, 2572, 4623, 4626, 5891, 2581, 535, 537, 2587, 8282, 9989, 8737, 8738, 6691, 6694,
         552, 8747, 558, 4189, 6709, 4662, 4663, 569, 4666, 3427, 572, 4674, 2629, 2630, 4681, 8778, 6732, 1122, 4687,
         4689, 8786, 9315, 4693, 599, 6244, 605, 2655, 7999, 2658, 613, 2664, 6761, 2666, 619, 6764, 8817, 4723, 2678,
         631, 633, 4732, 8830, 107, 2699, 652, 4750, 4753, 2708, 6806, 6807, 4762, 667, 2716, 8862, 5573, 4773, 6822,
         6826, 6829, 4893, 8881, 6365, 691, 2743, 116, 2746, 2747, 6846, 4801, 8898, 8899, 4809, 714, 4813, 2767, 720,
         6865, 4825, 2778, 8923, 2782, 8927, 2786, 1489, 8316, 4844, 4562, 4739, 1149, 752, 4849, 2803, 2174, 758, 2807,
         3296, 4859, 2812, 4861, 768, 3200, 772, 776, 780, 2832, 2835, 2836, 2837, 6938, 8989, 2848, 4897, 2277, 6948,
         3206, 6950, 6952, 6953, 6954, 2861, 2862, 8669, 6960, 9013, 9015, 6968, 2005, 7647, 828, 138, 6974, 9023, 832,
         6978, 9027, 6984, 2889, 6987, 6988, 2894, 6234, 3438, 2902, 5945, 7001, 2908, 866, 9019, 4967, 2924, 9069,
         9021, 880, 882, 7027, 7029, 4982, 4585, 148, 1855, 7872, 2941, 895, 896, 7041, 6157, 904, 9098, 2955, 9104,
         7059, 2964, 918, 4249, 2968, 9526, 2971, 988, 5028, 2981, 5030, 2983, 936, 6621, 5034, 2987, 7087, 9136, 7093,
         3002, 3003, 3004, 5053, 4597, 9154, 7109, 966, 7112, 1396, 970, 9165, 3022, 578, 982, 5080, 3033, 9180, 5086,
         3039, 3041, 9189, 3921, 5100, 3054, 3055, 9200, 9201, 7154, 9203, 7156, 9205, 1015, 9209, 7163, 5117, 1022,
         7172, 9225, 5133, 8365, 3088, 9233, 3090, 1043, 5142, 7191, 3853, 5145, 1050, 3099, 3100, 5149, 3102, 3103,
         9248, 7181, 9255, 5163, 5169, 5172, 9270, 6665, 2900, 7348, 3133, 5183, 9281, 2571, 7237, 1094, 5151, 3255,
         1100, 3149, 3597, 5202, 5207, 9500, 3163, 6330, 7266, 8379, 1125, 7273, 3178, 5227, 1135, 3184, 5234, 3188,
         3189, 1143, 3192, 5245, 1151, 5248, 9345, 1156, 7301, 1158, 1159, 9354, 2583, 3212, 7309, 3219, 9364, 1175, 39,
         5274, 4293, 7328, 9378, 1190, 7336, 5290, 9388, 5293, 3246, 2589, 1200, 6382, 3252, 3254, 1207, 7352, 5307,
         3260, 5309, 5310, 7523, 7360, 1218, 203, 9247, 6348, 5327, 3281, 1235, 1236, 8398, 9430, 7385, 9435, 9437,
         2360, 9440, 367, 3299, 1253, 3302, 8401, 9451, 7404, 9453, 3312, 8744, 7417, 1275, 5372, 3325, 5374, 5333,
         9473, 7426, 9475, 9476, 5386, 5388, 1293, 7438, 6360, 9490, 5396, 6931, 9498, 8295, 1308, 1311, 3364, 1317,
         3367, 5420, 9519, 1328, 1330, 5427, 7478, 5431, 1341, 7487, 7489, 9540, 9542, 9543, 7496, 5452, 1357, 7505,
         6371, 9557, 6713, 3416, 4069, 5468, 3422, 5471, 7521, 7522, 1595, 5477, 6716, 9578, 9911, 7532, 1389, 1390,
         7538, 7540, 7060, 9594, 1403, 1404, 1408, 7554, 1259, 1412, 2966, 3462, 5511, 1416, 7561, 1418, 9611, 1420,
         3650, 7064, 323, 1429, 3482, 6513, 5360, 5539, 7588, 5541, 8433, 3496, 3497, 3501, 5550, 5553, 9652, 7753,
         1466, 3515, 1468, 146, 3186, 4684, 2151, 7627, 5583, 5585, 3664, 5593, 1499, 3548, 5599, 5600, 1505, 7652,
         5610, 1515, 3564, 594, 3566, 3568, 6056, 1523, 9470, 8571, 3575, 5628, 5634, 3590, 9735, 3593, 1547, 5645,
         7697, 1554, 4007, 7769, 3608, 1564, 1565, 5662, 9759, 9760, 3620, 7718, 8455, 3633, 3635, 3642, 7739, 3644,
         7741, 7742, 5016, 5698, 5700, 7751, 5705, 9802, 9803, 5710, 5711, 1616, 5713, 7762, 3668, 1961, 3673, 5723,
         5727, 9824, 3682, 6075, 7441, 7788, 5394, 1648, 3697, 5746, 5757, 3710, 5762, 5764, 3719, 1675, 3729, 9878,
         7834, 1375, 7839, 7841, 3748, 1701, 3751, 7849, 5804, 9842, 9902, 9903, 1712, 1714, 3763, 1717, 1718, 7863,
         9912, 7868, 5824, 7873, 5826, 7877, 1736, 5840, 5842, 3796, 5845, 7895, 7896, 9948, 9950, 5855, 1760, 3809,
         9955, 1769, 1774, 5871, 7920, 7927, 7929, 3834, 5515, 298, 9675, 1791, 9985, 5890, 7939, 3030, 7943, 9992,
         9994, 3851, 1804, 9997, 6445, 7952, 1809, 1811, 1814, 1817, 5914, 1829, 4401, 8156, 7759, 5931, 1331, 3893,
         7991, 7993, 5946, 7997, 5951, 5771, 5956, 3382, 8006, 1863, 8009, 8010, 3199, 3272, 5969, 5974, 1631, 8028,
         8029, 3935, 5984, 8039, 8040, 1899, 5997, 5998, 6610, 1907, 6004, 6542, 3959, 1912, 4019, 3967, 3970, 3971,
         6024, 1929, 6026, 1936, 6035, 1944, 9577, 8094, 8098, 8100, 7494, 8103, 4008, 9884, 3399, 5107, 4020, 4021,
         4027, 6076, 6077, 6078, 8128, 1985, 6089, 8139, 6093, 2317, 8149, 7161, 9887, 8159, 8165, 2022, 2024, 2025,
         7296, 327, 7507, 8183, 6139, 8188, 4093, 6142, 8533]))
